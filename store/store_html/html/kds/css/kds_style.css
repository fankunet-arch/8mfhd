:root{
  --brand-500:#ED7762; --brand-600:#E46A54;
  --leaf-500:#22A06B;  --amber-500:#F59E0B;
  --danger-500:#EF4444; --info-500:#3B82F6;

  --ink-900:#111827; --ink-700:#374151; --muted-500:#6B7280;

  --bg:#E9EEF5; --bg-deeper:#E2E8F2;
  --surface:#FFFFFF; --card:#FFFFFF;

  --chip:#C7D2E2;
  --rail:#EEF2F7;
  --line:#D0D8E6; --line-strong:#B9C5D9;
  --shadow-sm:0 4px 14px rgba(17,24,39,.06);
  --shadow-md:0 14px 34px rgba(17,24,39,.12);

  --tap-size:44px;
  --flag-w:36px;
  --flag-h:24px;
}

html,body{height:100%;}
body{
  background: radial-gradient(1200px 700px at 55% 35%, var(--bg) 0%, var(--bg-deeper) 70%) fixed;
  color:var(--ink-900); overflow:hidden;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}
.kds-container{display:flex;height:100vh;width:100vw;}

/* --- SOP Page Specific Styles --- */
.kds-left-sidebar{width:280px;background:var(--surface);padding:1.5rem;flex-shrink:0;box-shadow:var(--shadow-md);z-index:10;border-right:1px solid var(--line);position: relative; padding-bottom: 44px;}
.kds-left-header{display:flex;flex-direction:column;gap:.6rem;margin-bottom:1.25rem;}
.kds-mode-row{display:flex;align-items:center;}
.kds-mode-switch{display:inline-grid; grid-auto-flow:column; align-items:center; gap:6px;height:40px; padding:4px;background:#F2F5FA; border:1px solid var(--line); border-radius:999px;box-shadow:var(--shadow-sm);}
.kds-mode-btn{display:inline-flex; align-items:center; gap:.4rem;height:32px; padding:0 14px;border-radius:999px; font-weight:900; font-size:.92rem; letter-spacing:.2px;color:#334155; text-decoration:none; line-height:32px;transition:all .15s ease;}
.kds-mode-btn .bi{font-size:1rem; opacity:.85;}
.kds-mode-divider{width:1px; height:24px; background:linear-gradient(#cfd6e5,#bfc9db); opacity:.9;border-radius:1px;}
.kds-mode-btn.active{background:var(--brand-500); color:#fff; box-shadow:0 6px 14px rgba(237,119,98,.28);}
.kds-mode-btn:not(.active):hover{background:#E9EEF7;}
.kds-cup-number{font-size:3.6rem;font-weight:900;color:var(--brand-500);line-height:1;margin-top:.25rem;}
.kds-info-display{background:linear-gradient(180deg,#F5F7FB 0%,#EFF3F9 100%);border-radius:.6rem;padding:.55rem .8rem;font-size:.92rem;margin-bottom:1rem;font-weight:700;border:1px solid var(--line);display:block;color:var(--ink-900);}
.btn-touch-action{min-height:50px;font-size:1.08rem;font-weight:700;border-radius:.7rem;box-shadow:var(--shadow-sm);}
.btn-success{background:var(--leaf-500);border-color:var(--leaf-500);}
.btn-outline-danger{color:var(--danger-500);border-color:var(--danger-500);}
.btn-outline-danger:hover{background:var(--danger-500);color:#fff;}
.kds-order-tags{list-style:none;padding:0;margin:0 0 1rem 0;display:flex;flex-direction:column;gap:.4rem;}
.kds-tag{align-self:flex-start; padding:.14rem .5rem; border-radius:.45rem; font-weight:800;font-size:.9rem; line-height:1.2; letter-spacing:.2px;color:#1f2937; background:#EEF2F7; border:1px solid var(--line);}
.kds-tag--warn{ color:#B91C1C; background:#FDECEC; border-color:#F9C6C6; }
.kds-main-content{flex-grow:1;display:flex;flex-direction:column;background:transparent;}
.kds-top-nav{background:#1F2937;color:#fff;padding:.6rem 1.5rem;display:flex;align-items:center;border-bottom:1px solid rgba(255,255,255,.06); box-shadow:0 10px 18px rgba(17,24,39,.18);}
.kds-top-nav .nav-link{color:rgba(255,255,255,.85);font-weight:700;border-bottom:2px solid transparent;border-radius:0;}
.kds-top-nav .nav-link:hover{color:#fff;}
.kds-top-nav .nav-link.active{color:#fff;border-bottom-color:var(--brand-500);}
.lang-switch{display:flex;align-items:center;gap:8px;}
.lang-flag{width:var(--tap-size); height:var(--tap-size);display:inline-flex; align-items:center; justify-content:center;border-radius:10px; cursor:pointer;outline: none;}
.lang-flag:focus-visible{ outline:2px solid rgba(59,130,246,.6); outline-offset:2px; }
.lang-flag.active .flag{ box-shadow:0 0 0 2px rgba(237,119,98,.6); border-color:rgba(237,119,98,.95); }
.flag{ width:var(--flag-w); height:var(--flag-h); display:block; border-radius:3px; border:1px solid rgba(0,0,0,.25); }
.kds-sop-area{flex-grow:1;padding:1.4rem 1.5rem;overflow:auto;background:linear-gradient(180deg, rgba(255,255,255,.0) 0%, rgba(17,24,39,.04) 100%),linear-gradient(180deg, var(--bg) 0%, var(--bg-deeper) 100%);}
.kds-steps{position:relative;padding-bottom:.65rem;}
.kds-steps::after{content:""; position:absolute; left:0; right:0; bottom:0;height:4px; background:var(--rail); border-radius:4px;}
.kds-step-tab{position:relative; display:inline-flex; align-items:center;height:36px; padding:0 12px; margin-right:.6rem; cursor:pointer;background:var(--chip); border:1px solid var(--line-strong); color:#0F172A;border-radius:999px; font-weight:900; letter-spacing:.2px;box-shadow:var(--shadow-sm); user-select:none; line-height:36px;outline: none;}
.kds-step-tab:focus-visible{ box-shadow:0 0 0 3px rgba(59,130,246,.35); }
.kds-step-tab .step-number{width:22px;height:22px; line-height:22px; text-align:center;background:rgba(0,0,0,.32); color:#fff; border-radius:999px; margin-right:.5rem;font-size:.8rem; font-weight:900;}
.kds-step-tab.active{ background:var(--brand-500); color:#fff; border-color:transparent; }
.kds-step-tab.active .step-number{ background:rgba(255,255,255,.28); }
.kds-step-tab.active::after{content:""; position:absolute; left:12px; right:12px; bottom:-9px;height:6px; background:var(--brand-500); border-radius:6px; box-shadow:0 3px 8px rgba(237,119,98,.35);}
.kds-tip{background:#F0F6F3;border:1px solid #CAE7D8;color:#166C4E;padding:.45rem .7rem;border-radius:.6rem; box-shadow:var(--shadow-sm);font-weight:800;}
.kds-ingredient-card{position:relative;border-radius:1rem;padding:1.25rem 1rem 1.1rem;text-align:center;background:var(--surface); border:1px solid var(--line);box-shadow:var(--shadow-sm);transition:transform .18s ease, box-shadow .18s ease;min-height:220px;}
.kds-ingredient-card:hover{box-shadow:0 16px 38px rgba(17,24,39,.16);transform:translateY(-2px);}
.kds-quantity{font-size:1.9rem;font-weight:900;color:var(--brand-500);margin-top:.25rem;letter-spacing:.6px;}
.kds-unit-measure{color:var(--muted-500);font-weight:700;}
.kds-side-cp{position: absolute;left: 50%;transform: translateX(-50%);bottom: 12px;font-size: 12px;line-height: 1.2;color: #111;opacity: .75;pointer-events: none;white-space: nowrap;}
.kds-top-actions .bi{font-size: 1.6rem;color: #fff;opacity: 0.8;transition: opacity 0.2s;vertical-align: middle;}
.kds-top-actions .bi:hover{opacity: 1;}
.kds-logout-btn{font-weight: 700;padding: .25rem .75rem;display: flex;align-items: center;line-height: 1.5;color: var(--danger-500);border-color: var(--danger-500);}
.kds-logout-btn:hover{color: #fff;background-color: var(--danger-500);border-color: var(--danger-500);}
.kds-logout-btn .bi{font-size: 1.1rem;opacity: 1;}

/* --- Prep Page Styles --- */
.prep-header {background-color: var(--surface);padding: 10px 20px;display: flex;justify-content: space-between;align-items: center;border-bottom: 1px solid var(--line);box-shadow: var(--shadow-md); z-index: 10;}
.prep-title {font-size: 1.5em;font-weight: bold; margin: 0;}
.btn-back {background-color: var(--muted-500);color: white;border: none;padding: 8px 16px;font-size: 0.9em;border-radius: 5px;cursor: pointer;text-decoration: none;display: inline-flex;align-items: center;gap: 8px;transition: background-color 0.2s;}
.btn-back:hover {background-color: var(--ink-700);}
.material-list {display: grid;grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));gap: 15px;}
.material-item {display: flex;flex-direction: column;align-items: center;justify-content: center;padding: 15px;border: 1px solid var(--line);border-radius: 5px; background: var(--surface);}
.material-name {font-size: 1.1em;margin-bottom: 15px;text-align: center; font-weight: 700;}
.btn-action {width: 100%;padding: 10px;border: none;border-radius: 5px;font-size: 1em;cursor: pointer;transition: background-color 0.2s;color: white; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 8px;}
.btn-open {background-color: var(--info-500);}
.btn-open:hover {background-color: #2972e0;}
.btn-prep {background-color: var(--leaf-500);}
.btn-prep:hover {background-color: #1e8a5b;}

/* --- START: UPDATED STYLES for Tab Layout --- */
.prep-container {
    display: flex;
    height: calc(100vh - 61px); /* Full height minus header */
}

.prep-sidebar {
    width: 200px;
    flex-shrink: 0;
    padding: 20px 10px 20px 20px;
    border-right: 1px solid var(--line);
    background-color: var(--surface); /* Keep background standard */
}

.prep-nav-link {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 1.1rem;
    font-weight: 700;
    padding: 12px 15px;
    margin-bottom: 10px;
    border-radius: 8px !important;
    color: var(--ink-700); /* Slightly darker default text */
    border: 1px solid transparent;
    transition: background-color 0.15s ease, color 0.15s ease, border-color 0.15s ease; /* Smooth transition */
}

.prep-nav-link .bi {
    font-size: 1.3rem;
    opacity: 0.6; /* Slightly dimmer default icon */
    transition: opacity 0.15s ease;
}

/* --- ENHANCED Active State --- */
.prep-nav-link.active {
    color: #FFFFFF !important; /* White text for contrast */
    background-color: var(--brand-500) !important; /* Use brand color */
    border-color: var(--brand-600) !important; /* Slightly darker border */
    box-shadow: 0 4px 10px rgba(237, 119, 98, 0.3); /* Add subtle shadow */
}

.prep-nav-link.active .bi {
    opacity: 1; /* Full opacity for active icon */
}
/* --- END ENHANCED Active State --- */


.prep-nav-link:not(.active):hover {
    background-color: var(--bg-deeper); /* Subtle hover */
    color: var(--ink-900);
}
.prep-nav-link:not(.active):hover .bi {
    opacity: 0.8;
}


.prep-content {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    /* Add a subtle background pattern or keep as is */
    background-color: var(--bg);
}

/* --- NEW: Search Bar Style --- */
.prep-search-bar {
    margin-bottom: 20px;
    position: relative;
}

.prep-search-bar .form-control {
    padding-left: 2.5rem; /* Space for the icon */
    border-radius: 8px;
    border: 1px solid var(--line-strong);
}

.prep-search-bar .search-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted-500);
}
/* --- END: Search Bar Style --- */


/* --- END STYLES for Tab Layout --- */

/* --- Expiry Page Styles --- */
.expiry-main { padding: 20px; height: calc(100vh - 61px); overflow: auto; body { overflow: auto; }}
.expiry-table { background-color: var(--surface); border-radius: 8px; box-shadow: var(--shadow-sm); }
.expiry-table th { background-color: var(--bg); }
.expiry-table .status-warning { background-color: #FFFBEB; } /* Amber 50 */
.expiry-table .status-danger { background-color: #FEF2F2; } /* Red 50 */
.expiry-table .status-danger td:nth-child(4) { font-weight: bold; color: var(--danger-500); }

@media (max-width:992px){.kds-left-sidebar{width:260px;}}
@media (max-width:768px){.kds-container{flex-direction:column;} .kds-left-sidebar{width:100%;box-shadow:none;border-right:none;border-bottom:1px solid var(--line); padding-bottom: 1rem;} body{overflow:auto;} .kds-left-header{gap:.5rem;} .kds-side-cp { position: static; transform: none; text-align: center; padding-top: 1rem;}}